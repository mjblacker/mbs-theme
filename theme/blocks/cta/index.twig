{% set background_type = fields.background_type ?: 'color' %}
{% set background_color = fields.background_color ?: '#FFF200' %}
{% set background_image_desktop = fields.background_image_desktop %}
{% set background_image_mobile = fields.background_image_mobile %}
{% set overlay_color = fields.overlay_color %}
{% set overlay_opacity = fields.overlay_opacity ?: 50 %}
{% set heading = fields.heading ?: 'Need it fast? Call us today.' %}
{% set sub_heading = fields.sub_heading ?: "Haven't got time to wait? Call us today for a quote and to see if we can help." %}
{% set button_text = fields.button_text ?: 'Contact us for a Quote' %}
{% set button_link = fields.button_link %}
{% set text_color = fields.text_color ?: 'dark' %}
{% set button_style = fields.button_style ?: 'dark' %}

{# Set text color classes based on selection #}
{% if text_color == 'light' %}
  {% set heading_classes = '!text-white' %}
  {% set sub_heading_classes = '!text-white text-opacity-90' %}
{% else %}
  {% set heading_classes = 'text-[#363738]' %}
  {% set sub_heading_classes = 'text-[#363738]' %}
{% endif %}

{# Set button style classes #}
{% if button_style == 'light' %}
  {% set button_classes = 'bg-white text-gray-800 hover:bg-gray-100' %}
{% elseif button_style == 'yellow' %}
  {% set button_classes = 'bg-yellow-400 text-gray-800 hover:bg-yellow-300' %}
{% else %}
  {% set button_classes = 'bg-[#363738] !text-white' %}
{% endif %}

{% if background_type == 'image' %}
  {% set desktop_bg_url = background_image_desktop ? background_image_desktop.url : '' %}
  {% set mobile_bg_url = background_image_mobile ? background_image_mobile.url : desktop_bg_url %}
  {% set fallback_bg_url = mobile_bg_url ?: desktop_bg_url %}
{% endif %}

<section class="cta-section relative overflow-hidden py-16 lg:py-20 min-h-[505px] lg:min-h-[464px]" 
         {% if background_type == 'color' %}
         style="background-color: {{ background_color }};"
         {% elseif background_type == 'image' and (desktop_bg_url or mobile_bg_url) %}
         style="
           {% if mobile_bg_url %}background-image: url('{{ mobile_bg_url }}');{% endif %}
           background-size: cover; 
           background-position: bottom; 
           background-repeat: no-repeat;
           {% if desktop_bg_url and desktop_bg_url != mobile_bg_url %}
           --desktop-bg: url('{{ desktop_bg_url }}');
           {% endif %}
         "
         {% if desktop_bg_url and desktop_bg_url != mobile_bg_url %}
         data-responsive-bg="true"
         {% endif %}
         {% endif %}>
  
  {# Background overlay for image backgrounds #}
  {% if background_type == 'image' and overlay_color and (desktop_bg_url or mobile_bg_url) %}
  <div class="absolute inset-0" 
       style="background-color: {{ overlay_color }}; opacity: {{ overlay_opacity / 100 }};"></div>
  {% endif %}
  
  {# CSS for responsive background images #}
  {% if background_type == 'image' and desktop_bg_url and desktop_bg_url != mobile_bg_url %}
  <style>
    @media (min-width: 1024px) {
      [data-responsive-bg="true"] {
        background-image: var(--desktop-bg) !important;
      }
    }
  </style>
  {% endif %}
  
  {# Main content container #}
  <div class="relative z-10 px-4 sm:px-6 lg:px-8 container mx-auto">
    <div class="cta-content">
      
      {# Content wrapper - centered layout #}
      <div class="text-center max-w-4xl mx-auto">
        
        {# Main Heading #}
        {% if heading %}
          <h3 class="font-medium leading-tight mb-4 mt-1 text-5xl sm:text-5xl {{ heading_classes }}">
            {{ heading }}
          </h3>
        {% endif %}
        
        {# Sub Heading #}
        {% if sub_heading %}
          <p class="text-xl sm:text-xl lg:text-2xl leading-relaxed mb-8 max-w-3xl mx-auto {{ sub_heading_classes }}">
            {{ sub_heading }}
          </p>
        {% endif %}
        
        {# Call to Action Button #}
        {% if button_text %}
          <div class="flex justify-center">
            {% if button_link and button_link.url %}
              <a href="{{ button_link.url }}" 
                 class="inline-flex items-center px-8 py-4 rounded-lg text-lg font-semibold transition-all duration-200 shadow-lg hover:shadow-xl hover:-translate-y-0.5 {{ button_classes }}"
                 {% if button_link.target %}target="{{ button_link.target }}"{% endif %}
                 {% if button_link.title %}aria-label="{{ button_link.title }}"{% endif %}>
                {{ button_text }}
              </a>
            {% else %}
              <button class="inline-flex items-center px-8 py-4 rounded-lg text-lg font-semibold transition-all duration-200 shadow-lg hover:shadow-xl hover:-translate-y-0.5 {{ button_classes }}">
                {{ button_text }}
              </button>
            {% endif %}
          </div>
        {% endif %}
        
      </div>
    </div>
  </div>
  
  
</section>